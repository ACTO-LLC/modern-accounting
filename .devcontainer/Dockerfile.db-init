FROM node:20-slim

WORKDIR /app

# Copy package files and install mssql
COPY package*.json ./
RUN npm install mssql

# Copy database project and deploy script
COPY database/ ./database/
COPY scripts/deploy-db.js ./scripts/

# Use Node.js mode explicitly since we're in a minimal container
# SqlPackage mode requires .NET SDK which isn't installed here
CMD ["node", "scripts/deploy-db.js", "--node"]
